[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "",
    "text": "This report summarises the bioinformatics workflow applied to the Chukchi Sea eRNA samples to study the Nitrogen cycles, particularly the denitrifcation and anammox metabolic pathways, using metatranscriptomics approach."
  },
  {
    "objectID": "index.html#sample-processing-sequencing-data-availability",
    "href": "index.html#sample-processing-sequencing-data-availability",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "üß™ Sample Processing, Sequencing & Data Availability",
    "text": "üß™ Sample Processing, Sequencing & Data Availability\nThe Centre for Genomic Research (CGR) processed 9 marine eRNA samples (+ 1 negative control) for metatranscriptomic sequencing as part of project SSP203072. The workflow included:\n\nDNase treatment of all extracted RNA samples.\nrRNA depletion using the Seawater riboPOOL kit.\nConstruction of Illumina RNA-seq libraries from the rRNA-depleted material.\n\nMultiplexing of all libraries and sequencing on one lane of an Illumina NovaSeq X Plus (NovaSeq X+) 25B flow cell.\nThis setup is expected to produce approximately ~325 million read pairs per sample, providing deep metatranscriptomic coverage suitable for resolving nitrogen-cycling pathways, including denitrification and anammox.\nFunding & administrative details:\n\nSSP ID: SSP203072\nPlatform: Illumina NovaSeq X+\nFunding: NEOF1819 ‚Äî Purchase Order P11212-200\n\nAll files‚Äîincluding raw data, processing details, and download instructions‚Äîare available via:\nProject data download"
  },
  {
    "objectID": "index.html#sequencing-output-cgr-qc-summary",
    "href": "index.html#sequencing-output-cgr-qc-summary",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "üìä Sequencing Output & CGR QC Summary",
    "text": "üìä Sequencing Output & CGR QC Summary\n\n\n\n\n\n\n\n\n\n\nName\nRaw Reads (M)\nTrimmed Reads (M)\nRaw Bases (M)\nTrimmed Bases (M)\n\n\n\n\n1-S4S\n422.03\n418.30\n126,608.75\n120,507.35\n\n\n2-S4M\n559.84\n557.67\n167,952.06\n163,451.31\n\n\n3-S4B\n613.03\n611.42\n183,908.71\n179,372.50\n\n\n4-S13S\n9.89\n7.81\n2,968.42\n2,244.11\n\n\n5-S13M\n240.41\n238.67\n72,124.26\n70,520.45\n\n\n6-S13B\n617.78\n615.94\n185,334.01\n181,063.09\n\n\n7-S14S\n526.76\n524.35\n158,026.71\n153,976.49\n\n\n8-S14M\n526.33\n524.19\n157,899.00\n153,074.61\n\n\n9-S14B\n571.17\n569.59\n171,349.89\n166,325.31\n\n\n10-negative_control\n5.92\n5.16\n1,776.58\n1,487.48\n\n\n\nDescription of Methods The raw FASTQ files are trimmed for the presence of Illumina adapter sequences using Cutadapt version 4.5 . The option -O 3 was used, meaning that trimming occurred in reads where at least 3bp of adapter sequence was observed at the 3‚Äô end of the read. The reads were further trimmed to remove low quality bases with a minimum window quality score of 20. After trimming, reads shorter than 15 bp were removed. Only read pairs are retained, therefore if a read of a pair is trimmed away then the other read in the pair is also discarded.\n\n\n\n\n\n\nNoteüìù Notes on Low-Yield Samples\n\n\n\n4-S13S returned an exceptionally low number of reads because very little RNA was recovered from the corresponding Sterivex filters. This limited input material resulted in poor library complexity and low overall sequencing yield.\n10-negative_control is a processing negative control sample and therefore contains no biological RNA. The very low read count is expected and confirms that minimal contamination occurred during library preparation."
  },
  {
    "objectID": "index.html#rrna-removal-sortmerna",
    "href": "index.html#rrna-removal-sortmerna",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "rRNA Removal ‚Äì SortMeRNA",
    "text": "rRNA Removal ‚Äì SortMeRNA\nTo enrich for mRNA and other non-rRNA transcripts, we removed ribosomal RNA using SortMeRNA.\nThe command below shows the SortMeRNA run that was used for each sample. We used the CGR-trimmed paired-end reads as input and the smr_v4.3_sensitive_db_rfam_seeds database for rRNA identification.\n\nsortmerna \\\n  --ref \"smr_v4.3_sensitive_db_rfam_seeds.fasta\" \\\n  --reads \"$R1\" \\\n  --reads \"$R2\" \\\n  --threads \"$SLURM_CPUS_PER_TASK\" \\\n  --fastx \\\n  --out2 \\\n  --paired_in \\\n  --aligned \"${SAMPLE}_rRNA\" \\\n  --other \"${SAMPLE}_RNA_clean\" \\\n  --workdir \"$WORKDIR\"\nFor each sample, SortMeRNA produces:\nrRNA files containing reads classified as rRNA\nRNA_clean files containing the rRNA-depleted read pairs, which are carried forward to assembly."
  },
  {
    "objectID": "index.html#de-novo-assembly-megahit",
    "href": "index.html#de-novo-assembly-megahit",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "De Novo Assembly ‚Äì MEGAHIT",
    "text": "De Novo Assembly ‚Äì MEGAHIT\nWe performed a co-assembly of selected rRNA-depleted samples using MEGAHIT, optimised for complex metatranscriptomic data with the meta-sensitive preset. For illustration, the command below shows the co-assembly of samples:\nmegahit \n-1 [station_samples]_RNA_clean_fwd.fq.gz \n-2 [station_samples]_RNA_clean_rev.fq.gz \n-t 60 \n--presets meta-sensitive \n--min-contig-len 500 \n-m 0.9 \n-o St[1:3]_megahit_out\nAssembly statistics for an example MEGAHIT run (St1) were obtained using seqkit:\nseqkit stats final.contigs.fa\nFor example (St1 assembly):\n\n\n\n\n\n\n\n\n\n\n\nAssembly\n# Contigs\nTotal Length (bp)\nMin Length (bp)\nMean Length (bp)\nMax Length (bp)\n\n\n\n\nfinal.contigs.fa\n1,432,902\n1,457,453,119\n500\n1,017.1\n106,426\n\n\n\nThese statistics indicate a highly fragmented but deep assembly, typical of complex marine microbial metatranscriptomes, with contigs ‚â•500 bp retained for downstream analyses."
  },
  {
    "objectID": "index.html#read-mapping-bowtie2-and-samtools",
    "href": "index.html#read-mapping-bowtie2-and-samtools",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "Read Mapping ‚Äì Bowtie2 and Samtools",
    "text": "Read Mapping ‚Äì Bowtie2 and Samtools\nTo quantify transcript coverage across assembled contigs, we mapped the rRNA-depleted reads back to the MEGAHIT assembly using Bowtie2, followed by BAM processing with Samtools.\nFirst, we built a Bowtie2 index from the fixed assembly:\nbowtie2-build St1_assembly-fixed.fa St1_assembly-fixed\nThen, for each sample, paired-end reads were aligned and processed as follows:\nIDX=\"St1_assembly-fixed\"\nR1=\"SAMPLE_RNA_clean_fwd.fq.gz\"\nR2=\"SAMPLE_RNA_clean_rev.fq.gz\"\nTHREADS=16\nOUT=\"St1_SAMPLE\"\n\nMap paired-end reads\n\nbowtie2 -x \"${IDX}\"\n-1 \"${R1}\"\n-2 \"${R2}\"\n-p \"${THREADS}\"\n-S \"${OUT}.sam\"\n\nConvert to BAM, keep mapped reads only (-F 4), sort and index\n\nsamtools view -F 4 -bS \"${OUT}.sam\" -o \"${OUT}-RAW.bam\"\nsamtools sort -@ \"${THREADS}\" \"${OUT}-RAW.bam\" -o \"${OUT}.bam\"\nsamtools index \"${OUT}.bam\"\nThe resulting sorted and indexed BAM files (.bam, .bam.bai) are used as input for downstream coverage estimation and gene- or contig-level quantification in anvi‚Äôo."
  },
  {
    "objectID": "index.html#creating-anvio-databases",
    "href": "index.html#creating-anvio-databases",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "Creating anvi‚Äôo Databases",
    "text": "Creating anvi‚Äôo Databases\nSubsequent steps involved importing the assemblies and mapped reads into anvi‚Äôo to facilitate contig profiling, annotation, and interactive exploration of nitrogen-cycle genes (e.g.¬†denitrification and anammox pathways).\nIn brief, the workflow included:\n\nCreating a contigs database from the MEGAHIT assembly\nRunning HMMs and functional annotation (e.g.¬†PFAM, TIGRFAMs, KOfam)\nProfiling BAM files for each sample to obtain coverage and detection statistics\nMerging profiles across samples for joint inspection and downstream analyses\n\nExample (commands will vary slightly depending on environment and anvio version):\n\nCreate contigs database\n\nanvi-gen-contigs-database -f St1_assembly-fixed.fa -o St1_contigs.db -n \"St1 Chukchi Sea metaT\"\n\nRun HMMs (standard anvio collection)\n\nanvi-run-hmms -c St1_contigs.db --num-threads 20\n\nProfile each BAM file\n\nanvi-profile -i St1_SAMPLE.bam -c St1_contigs.db\n--output-dir St1_SAMPLE_profile\n--num-threads 20\n\nMerge profiles across samples\n\nanvi-merge St1_*_profile/PROFILE.db -o St1_merged_profiles -c St1_contigs.db\nThese anvi‚Äôo databases form the basis for functional annotation and visualisation of key nitrogen-cycle pathways in the Chukchi Sea metatranscriptomes."
  },
  {
    "objectID": "index.html#functional-annotation-of-genes",
    "href": "index.html#functional-annotation-of-genes",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "üîç Functional Annotation of genes",
    "text": "üîç Functional Annotation of genes\nTo characterise the metabolic potential represented in the metatranscriptomic assembly, we performed extensive functional annotation of the anvi‚Äôo contigs database. This step links assembled sequences to known protein families, orthologous groups, and taxonomic markers, enabling downstream interpretation of nitrogen-cycle genes (e.g., denitrification, anammox).\nWe used the following anvi‚Äôo annotation programs:\nanvi-run-hmms\nIdentifies single-copy core genes (SCGs) and key conserved protein families using anvi‚Äôo‚Äôs curated HMM collections. This provides quality metrics for assemblies and forms the basis for taxonomic inference.\nanvi-run-ncbi-cogs\nAssigns Clusters of Orthologous Groups (COGs) from NCBI to contigs based on predicted open reading frames. COG categories help identify broad functional roles such as energy production, amino acid metabolism, stress response, etc.\nanvi-run-kegg-kofams\nAnnotates genes using KEGG Orthologs (KOfam HMMs), providing pathway-level information including nitrogen cycling modules (e.g., nitrate reduction, nitrification, denitrification, anammox).\nanvi-run-scg-taxonomy\nUses single-copy core gene content to infer taxonomic origin of contigs, giving insight into which microbial groups are contributing to specific nitrogen-cycling pathways."
  },
  {
    "objectID": "index.html#metabolic-reconstruction-and-pathway-visualisation",
    "href": "index.html#metabolic-reconstruction-and-pathway-visualisation",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "üî¨ Metabolic Reconstruction and Pathway Visualisation",
    "text": "üî¨ Metabolic Reconstruction and Pathway Visualisation\nFollowing functional annotation, we performed metabolic inference and pathway-level analysis using anvi‚Äôo‚Äôs metabolism suite. These tools integrate KEGG Ortholog (KOfam) annotations with curated pathway models to identify which biochemical pathways are represented in the dataset and to visualise how transcripts map onto specific metabolic processes‚Äîparticularly those involved in nitrogen cycling.\nWe used the following anvi‚Äôo programs:\nanvi-estimate-metabolism\nIdentifies complete and partial KEGG modules across all annotated contigs, providing an overview of metabolic potential (e.g., denitrification, dissimilatory nitrate reduction, anammox).\nanvi-react-network\nGenerates reaction-centric metabolic networks based on KEGG reactions detected in the assembly. This allows exploration of how individual reactions connect into broader nitrogen pathways.\nanvi-reaction-network\nCreates interactive network files linking genes (KO identifiers), reactions, and pathways‚Äîuseful for mapping expression levels or identifying pathway bottlenecks.\nanvi-draw-kegg\nRenders KEGG metabolic pathway diagrams annotated with detected genes, enabling visual inspection of pathway completeness and highlighting which steps are supported by metatranscriptomic evidence.\nThese tools collectively provide a pathway-level view of nitrogen cycling activity in the Chukchi Sea microbial community, enabling detailed interpretation of expression patterns associated with denitrification, nitrification, and anammox processes."
  },
  {
    "objectID": "index.html#kegg-module-m00529-denitrification-nitrate-nitrogen",
    "href": "index.html#kegg-module-m00529-denitrification-nitrate-nitrogen",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "KEGG Module M00529 ‚Äî Denitrification (nitrate ‚Üí nitrogen)",
    "text": "KEGG Module M00529 ‚Äî Denitrification (nitrate ‚Üí nitrogen)\n\n\n\nKEGG module M00529 (Denitrification, nitrate ‚Üí nitrogen). Diagram from https://www.genome.jp/dbget-bin/www_bget?md:M00529\n\n\nFrom the output of anvi-estimate-metabolism, we can look for the KEGG module for Denitrification (M00529) and look at its completeness:\n\n\n\n\n\n\n\n\n\nKEGG Module\nStation\nstepwise_module_completeness\npathwise_module_completeness\n\n\n\n\nM00529\nStation_1\n1.00\n1.00\n\n\nM00529\nStation_2\n1.00\n1.00\n\n\nM00529\nStation_3\n1.00\n1.00\n\n\n\nSo all the genes required for denitrification to occur seem to be detected at each of the stations.\nLet‚Äôs look at the denitrification pathway in more details using anvi-interactive, so we can see the coverage of the genes involved in denitrification across the 3 depths in the stations.\nFirst, we need to create an anvi‚Äôo collection that contains all the denitrification genes. Using anvi-export-functions we can get the gene_callers_ids matching your KO IDs, then we can get the contigs name using anvi-export-table ‚Äìtable genes_in_contigs. After that we need to use join to find the contigs that have the genes of interest and finally we need to add ‚Äú_split_00001‚Äù to each contig name (because in this case each contig has only one split as these come from metaT assembly. We ad a column with the name of our bin and then can import that using anvi-import-collection\nanvi-export-functions   -c St1_contigs.db   -o St1_gene_functions.tsv\nanvi-export-table --table genes_in_contigs -o St1_genes_in_contigs.tsv St1_contigs.db\ntail -n +2 St1_genes_in_contigs.tsv | cut -f1,2 &gt; gene_to_contig.tsv\n\n# KO list for denitrification (edit/add as needed)\nKOS='K00370|K00371|K00374|K02567|K02568|K00368|K15864|K04561|K02305|K00376'\n# Get unique gene_callers_id hits for those KOs\nawk -F'\\t' -v kos=\"$KOS\" '($3 ~ kos){print $1}' St1_gene_functions.tsv   | sort -u &gt; genes_of_interest.ids\njoin -t $'\\t' genes_of_interest.ids gene_to_contig.tsv   | cut -f2   | sort -u &gt; contigs_of_interest.txt\nawk '{print $1\"_split_00001\\tdenitrification\"}' contigs_of_interest.txt   &gt; denitrification_splits_collection.tsv\n\nanvi-import-collection   -p St1_MERGED/PROFILE.db   -c St1_contigs.db   -C denitrification_splits denitrification_splits_collection.tsv\nNow that we have an anvio collection, we need to ‚Äúsplit‚Äù it from the main contigs and profile databases (we create a subset). This is because our initial contigs.be has too many splits (1,432,906 splits to be precise) and hierarchical clustering gets turned off.\nOnce it is splitted we can find a directory called ‚Äúdenitrifications_splits‚Äù in which we find a contigs and profile database that we can now plot using anvi-interactive:"
  },
  {
    "objectID": "index.html#anvio-interactive-plot---denitrification---nitrate-reductase---station-1",
    "href": "index.html#anvio-interactive-plot---denitrification---nitrate-reductase---station-1",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "anvi‚Äôo interactive plot - Denitrification - Nitrate reductase - Station 1",
    "text": "anvi‚Äôo interactive plot - Denitrification - Nitrate reductase - Station 1\n\n\n\nAnvi‚Äôo interactive plot"
  },
  {
    "objectID": "index.html#anvio-interactive-plot---denitrification---nitrite-reductase-nirk---station-1",
    "href": "index.html#anvio-interactive-plot---denitrification---nitrite-reductase-nirk---station-1",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "anvi‚Äôo interactive plot - Denitrification - Nitrite reductase (nirK) - Station 1",
    "text": "anvi‚Äôo interactive plot - Denitrification - Nitrite reductase (nirK) - Station 1\n\n\n\nAnvi‚Äôo interactive plot\n\n\nNow we can start looking for specific genes and creating bins for each so we can visualise them and see their coverage."
  },
  {
    "objectID": "index.html#kegg-map-of-nitrogen-pathways",
    "href": "index.html#kegg-map-of-nitrogen-pathways",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "KEGG Map of Nitrogen Pathways",
    "text": "KEGG Map of Nitrogen Pathways\n\n\n\nKEGG map of Nitrogen metabolic pathways. Diagram from anvi‚Äôo and KEGG. In green are the genes present in anvio contig database for Station 1"
  },
  {
    "objectID": "index.html#kegg-nitrogen-cycle-map00910",
    "href": "index.html#kegg-nitrogen-cycle-map00910",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "KEGG nitrogen cycle (map00910)",
    "text": "KEGG nitrogen cycle (map00910)\nThis is a standard, widely used KO set covering:\n\nNitrification\nDenitrification\nDNRA\nAnammox\nNitrogen fixation\n\nAssimilatory pathways\n\nCore nitrogen-cycle KOs (map00910)\n\nNitrogen fixation K02588 nifH K02591 nifD K02586 nifK\nNitrification K10944 amoA K10945 amoB K10946 amoC K10535 hao\nAssimilatory nitrate reduction K00367 nasA K00360 nirA\nDissimilatory nitrate reduction (DNRA) K00362 napA K00363 napB K00370 narG K00371 narH K00374 narI K02567 nrfA K02568 nrfH\nDenitrification K00368 nirK K15864 nirS K04561 norB K02305 norC K00376 nosZ\nAnammox K20932 hzsA K20933 hzsB K20934 hzsC K20935 hdh"
  },
  {
    "objectID": "index.html#tara-oceans-arctic-data-as-reference",
    "href": "index.html#tara-oceans-arctic-data-as-reference",
    "title": "BIOPOLE - Chukchi Sea metatranscriptomics analysis report",
    "section": "Tara Oceans Arctic data as reference",
    "text": "Tara Oceans Arctic data as reference\n\nRationale and overview\nAs no site-matched metagenomic data were available for these samples, a reference-based approach was adopted using publicly available metagenomic data from the Tara Oceans Arctic expedition (Station 194), representing the closest comparable marine Arctic microbial communities currently available.\n 2:45 AM on September 8, 2013 (UTC)\n\n\nStation 194 - Tara Oceans Polar Circle expedition\n\n\n\nField\nValue\n\n\n\n\nBioSamples ID\nSAMEA4397903\n\n\nENA Run ID\nERR3589571\n\n\nDate/Time\n2013-09-12T03:59:00Z\n\n\nLatitude\n73.3275\n\n\nLongitude\n-168.8142\n\n\nDepth\n35\n\n\nLayer\nDCM\n\n\nSize fraction\n0.22‚Äì3\n\n\nRegion\nArctic Ocean\n\n\n\nThis strategy enables the detection and quantification of expressed genes that are conserved between Arctic marine microbial communities, while acknowledging that locally specific taxa or gene variants not present in the reference dataset may not be captured.\n\n\nAssembly of Tara Oceans Arctic metagenomes\nRaw metagenomic reads from the Tara Oceans Arctic expedition were assembled de novo using MEGAHIT, which is optimized for large and complex metagenomic datasets. The resulting assembly produced a set of contigs representing microbial genomic fragments present in Arctic marine surface waters.\nThese contigs were subsequently used as a reference database for read mapping. While the Tara Oceans sampling locations do not overlap geographically with the Chukchi Sea, they provide a comprehensive representation of Arctic marine microbial diversity and metabolic potential, particularly for conserved biogeochemical pathways such as nitrogen cycling.\n\n\nMetatranscriptomic read processing and mapping\nQuality-filtered metatranscriptomic reads were mapped to the Tara Oceans Arctic contigs using Bowtie2 with default end-to-end alignment settings. Mapping was performed in paired-end mode to improve alignment specificity. Both concordant and discordant alignments were reported, although downstream analyses focused on concordantly mapped read pairs.\nMapping performance and alignment statistics\nAcross samples, overall alignment rates ranged from 15.8% to 27.3% of paired-end reads mapping to the Tara Oceans Arctic contigs. The majority of reads aligned concordantly exactly once (11‚Äì18%), with a smaller proportion aligning to multiple locations (3‚Äì6%). Discordant alignments accounted for approximately 0.5‚Äì1% of read pairs.\nThese mapping rates are consistent with expectations for metatranscriptomic datasets mapped to non-site-matched metagenomic references, particularly in polar marine systems where microbial communities exhibit strong spatial structure and strain-level diversity. The observed alignment patterns suggest that a substantial fraction of expressed genes in the Chukchi Sea microbial community are shared with, or closely related to, those represented in the Tara Oceans Arctic metagenomes.\nInterpretation and limitations\nThis reference-based approach enables the identification and relative quantification of expressed genes that are conserved across Arctic marine microbial communities, including key genes involved in nitrogen cycling. However, transcripts derived from locally unique taxa or divergent gene variants absent from the Tara Oceans reference assembly are unlikely to be captured, resulting in an underestimation of total transcript diversity and expression.\nConsequently, analyses based on this approach focus on relative expression patterns of nitrogen-cycle gene families represented in the reference dataset, rather than absolute transcript abundances or the absence of specific metabolic pathways. Despite these limitations, the approach provides a robust framework for exploring nitrogen cycling activity in the Chukchi Sea in the absence of site-specific metagenomic data."
  }
]